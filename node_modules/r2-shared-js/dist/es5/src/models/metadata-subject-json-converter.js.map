{"version":3,"file":"metadata-subject-json-converter.js","sourceRoot":"","sources":["../../../../src/models/metadata-subject-json-converter.ts"],"names":[],"mappings":";;;AASA,wDAA6E;AAE7E,uDAA6C;AAI7C;IAAA;IA0CA,CAAC;IAzCU,wCAAS,GAAhB,UAAiB,CAAU;QACvB,IAAI,CAAC,CAAC,IAAI;YACN,CAAC,CAAC,CAAC,MAAM;YACT,CAAC,CAAC,CAAC,MAAM;YACT,CAAC,CAAC,CAAC,IAAI;YACP,CAAC,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC;YAChC,IAAI,OAAO,CAAC,CAAC,IAAI,KAAK,QAAQ,EAAE,CAAC;gBAC7B,OAAO,CAAC,CAAC,IAAI,CAAC;YAClB,CAAC;QAIL,CAAC;QACD,OAAO,IAAA,8BAAe,EAAC,CAAC,CAAC,CAAC;IAC9B,CAAC;IAEM,0CAAW,GAAlB,UAAmB,KAAgB;QAC/B,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE,CAAC;YAC5B,IAAM,CAAC,GAAG,IAAI,0BAAO,EAAE,CAAC;YACxB,CAAC,CAAC,IAAI,GAAG,KAAe,CAAC;YACzB,OAAO,CAAC,CAAC;QACb,CAAC;QAcD,OAAO,IAAA,gCAAiB,EAAU,KAAK,EAAE,0BAAO,CAAC,CAAC;IACtD,CAAC;IAEM,0DAA2B,GAAlC;QACI,OAAO,IAAI,CAAC;IAChB,CAAC;IACL,2BAAC;AAAD,CAAC,AA1CD,IA0CC;AA1CY,oDAAoB","sourcesContent":["// ==LICENSE-BEGIN==\n// Copyright 2017 European Digital Reading Lab. All rights reserved.\n// Licensed to the Readium Foundation under one or more contributor license agreements.\n// Use of this source code is governed by a BSD-style license\n// that can be found in the LICENSE file exposed on Github (readium) in the project repository.\n// ==LICENSE-END==\n\nimport { IPropertyConverter, JsonValue } from \"ta-json-x\";\n\nimport { TaJsonDeserialize, TaJsonSerialize } from \"@r2-lcp-js/serializable\";\n\nimport { Subject } from \"./metadata-subject\";\n\n// import { IStringMap } from \"./metadata-multilang\";\n\nexport class JsonSubjectConverter implements IPropertyConverter {\n    public serialize(s: Subject): JsonValue {\n        if (s.Name &&\n            !s.SortAs &&\n            !s.Scheme &&\n            !s.Code &&\n            (!s.Links || !s.Links.length)) {\n            if (typeof s.Name === \"string\") {\n                return s.Name;\n            }\n            // else if (typeof s.Name === \"object\") {\n            //     return s.Name; // IStringMap\n            // }\n        }\n        return TaJsonSerialize(s);\n    }\n\n    public deserialize(value: JsonValue): Subject {\n        if (typeof value === \"string\") {\n            const s = new Subject();\n            s.Name = value as string;\n            return s;\n        }\n        // else if (typeof value === \"object\" && !(value as any)[\"name\"]) { // tslint:disable-line:no-string-literal\n        //     const s = new Subject();\n        //     s.Name = {} as IStringMap;\n        //     const keys = Object.keys(value as any);\n        //     keys.forEach((key: string) => {\n        //         // TODO? check key is BCP47 language tag?\n        //         const val = (value as any)[key];\n        //         if (typeof val === \"string\") {\n        //             (s.Name as IStringMap)[key] = val;\n        //         }\n        //     });\n        //     return s;\n        // }\n        return TaJsonDeserialize<Subject>(value, Subject);\n    }\n\n    public collapseArrayWithSingleItem(): boolean {\n        return true;\n    }\n}\n"]}