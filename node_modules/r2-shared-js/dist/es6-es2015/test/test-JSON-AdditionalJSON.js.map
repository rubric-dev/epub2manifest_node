{"version":3,"file":"test-JSON-AdditionalJSON.js","sourceRoot":"","sources":["../../../test/test-JSON-AdditionalJSON.ts"],"names":[],"mappings":"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","sourcesContent":["import test from \"ava\";\nimport * as path from \"path\";\n\nimport { Metadata } from \"@models/metadata\";\nimport { Publication } from \"@models/publication\";\nimport { setLcpNativePluginPath } from \"@r2-lcp-js/parser/epub/lcp\";\nimport { JsonArray, JsonMap, TaJsonDeserialize, TaJsonSerialize } from \"@r2-lcp-js/serializable\";\n\nimport { initGlobalConverters_GENERIC, initGlobalConverters_SHARED } from \"../src/init-globals\";\nimport {\n    checkType_Array, checkType_Number, checkType_Object, checkType_String, inspect, logJSON,\n} from \"./helpers\";\n\ninitGlobalConverters_SHARED();\ninitGlobalConverters_GENERIC();\n\nsetLcpNativePluginPath(path.join(process.cwd(), \"LCP\", \"lcp.node\"));\n\n// ==========================\n\nconst titleStr1 = \"str1\";\nconst titleStr2 = \"str2\";\nconst titleStr3 = \"str3\";\nconst n = 999;\n\n// ==========================\n\ntest(\"JSON SERIALIZE: Metadata.AdditionalJSON\", (t) => {\n\n    const md = new Metadata();\n    md.Title = titleStr1;\n    md.AdditionalJSON = {\n        title2: titleStr2,\n        tizz: {\n            sub1: true,\n            sub2: null,\n            sub3: {\n                inner1: n,\n                inner2: [titleStr3, 888, false],\n            },\n        },\n    };\n    const pub = new Publication();\n    pub.Metadata = md;\n    inspect(pub);\n\n    const jsonPub = TaJsonSerialize(pub);\n    logJSON(jsonPub);\n    const json = jsonPub.metadata as JsonMap;\n\n    checkType_String(t, json.title);\n    t.is(json.title, titleStr1);\n\n    if (!json.tizz) {\n        t.fail();\n        return;\n    }\n    checkType_Object(t, json.tizz);\n\n    t.is((json.tizz as JsonMap).sub1, true);\n\n    if ((json.tizz as JsonMap).sub2 || (json.tizz as JsonMap).sub2 !== null) {\n        t.fail();\n        return;\n    }\n\n    if (!(json.tizz as JsonMap).sub3) {\n        t.fail();\n        return;\n    }\n\n    checkType_Number(t, ((json.tizz as JsonMap).sub3 as JsonMap).inner1);\n    t.is(((json.tizz as JsonMap).sub3 as JsonMap).inner1, n);\n\n    if (!((json.tizz as JsonMap).sub3 as JsonMap).inner2) {\n        t.fail();\n        return;\n    }\n    checkType_Array(t, ((json.tizz as JsonMap).sub3 as JsonMap).inner2);\n    t.is((((json.tizz as JsonMap).sub3 as JsonMap).inner2 as JsonArray)[0], titleStr3);\n\n    if (!((json.tizz as JsonMap).sub3 as JsonMap).inner1) {\n        t.fail();\n        return;\n    }\n});\n\ntest(\"JSON DESERIALIZE: Metadata.AdditionalJSON\", (t) => {\n\n    const json: JsonMap = {\n        title: titleStr1,\n        title2: titleStr2,\n        tizz: {\n            sub1: true,\n            sub2: null,\n            sub3: {\n                inner1: 999,\n                inner2: [titleStr3, 888, false],\n            },\n        },\n    };\n    const jsonPub: JsonMap = {\n        metadata: json,\n    };\n    logJSON(jsonPub);\n\n    const pub: Publication = TaJsonDeserialize<Publication>(jsonPub, Publication);\n    const md = pub.Metadata;\n    // const md: Metadata = TaJsonDeserialize<Metadata>(json, Metadata);\n    inspect(md);\n\n    checkType_String(t, md.Title);\n    t.is(md.Title, titleStr1);\n\n    if (!md.AdditionalJSON) {\n        t.fail();\n        return;\n    }\n    checkType_String(t, md.AdditionalJSON.title2);\n    t.is(md.AdditionalJSON.title2, titleStr2);\n\n    if (!md.AdditionalJSON.tizz) {\n        t.fail();\n        return;\n    }\n    checkType_Object(t, md.AdditionalJSON.tizz);\n\n    t.is((md.AdditionalJSON.tizz as JsonMap).sub1, true);\n\n    if ((md.AdditionalJSON.tizz as JsonMap).sub2 ||\n        (md.AdditionalJSON.tizz as JsonMap).sub2 !== null) {\n        t.fail();\n        return;\n    }\n\n    if (!(md.AdditionalJSON.tizz as JsonMap).sub3) {\n        t.fail();\n        return;\n    }\n\n    checkType_Number(t, ((md.AdditionalJSON.tizz as JsonMap).sub3 as JsonMap).inner1);\n    t.is(((md.AdditionalJSON.tizz as JsonMap).sub3 as JsonMap).inner1, n);\n\n    if (!((md.AdditionalJSON.tizz as JsonMap).sub3 as JsonMap).inner2) {\n        t.fail();\n        return;\n    }\n    checkType_Array(t, ((md.AdditionalJSON.tizz as JsonMap).sub3 as JsonMap).inner2);\n    t.is((((md.AdditionalJSON.tizz as JsonMap).sub3 as JsonMap).inner2 as JsonArray)[0], titleStr3);\n\n    if (!((md.AdditionalJSON.tizz as JsonMap).sub3 as JsonMap).inner1) {\n        t.fail();\n        return;\n    }\n});\n"]}